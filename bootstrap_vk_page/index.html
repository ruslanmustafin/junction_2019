<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <script type="text/javascript" src="two.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Carousel cards</title>

    <style>
        /* CSS Document */

        .carousel-inner img {
            margin: auto;
        }

        #photosCarousel {
            background-color: #000000;
            color: #000000;
        }



        /* equal card height */
        .row-equal>div[class*='col-'] {
            display: flex;
            flex: 1 0 auto;
        }

        .row-equal .card {
            width: 100%;
        }

        /* ensure equal card height inside carousel */
        .carousel-inner>.row-equal.active,
        .carousel-inner>.row-equal.next,
        .carousel-inner>.row-equal.prev {
            display: flex;
        }

        /* prevent flicker during transition */
        .carousel-inner>.row-equal.active.left,
        .carousel-inner>.row-equal.active.right {
            opacity: 0.5;
            display: flex;
        }


        /* control image height */
        .card-img-top-250 {
            max-height: 250px;
            overflow: hidden;
        }

        #container {
            position: relative;
        }

        #svg-overlay {
            position: absolute;
            top: 0;
            left: 0;
        }

        .product-image {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 50%;
        }
    </style>

</head>

<body>


    <div class="row">
        <div class="col-xs-12 col-md-8">
            <div id="photosCarousel" class="carousel" data-ride="carousel" data-interval="false">
                <div class="carousel-inner">
                    <div class="carousel-item active" id="container">
                        <img class="d-block w-50" src="clothes/ds/img/1.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/73SbsfjizLc.jpg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/asdas.jpg" alt="Third slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/FJC__zMiv-w.jpg" alt="Third slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/full-938308488-1-1461087254.jpg"
                            alt="Third slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/iKVphIPYr-0.jpg" alt="Third slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-50" src="clothes/ds/img/kTLuFj70ko8.jpg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" onclick="clearBox('svg-overlay')" href="#photosCarousel" role="button"
                    data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" onclick="clearBox('svg-overlay')" href="#photosCarousel" role="button"
                    data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

            <div id='svg-overlay'></div>
        </div>
        <div class="col-xs-6 col-md-4">
            <button type="button" id='processButton' class="btn btn-primary btn-lg btn-block">ValiK</button>

        </div>
    </div>


    <section class="carousel slide" style="display: none;" data-ride="carousel" id="productsCarousel"
        data-interval="false">
        <div class="container p-t-0 m-t-2 carousel-inner">
            <div class="row row-equal carousel-item active m-t-0">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-img-top card-img-top-250">
                            <div class="product-image"><a target="_blank"
                                    href="https://api.aliseeks.com/products/redirect?path=AfH6f72Kph5261XIds8Fk7DbtSClCi1P%2BY8Ufj1PO6wLXFGbLPSzH2qbCWk0LlOvyXKApMJ2jfMwVFbpMQCENZcIjY6Ie6QLHx6vBwsHPj6TNlkA76frxxIhtvqtFhU2xmJhf6gdYk0w8hesrtyRlXObhQ6zLpzd1Is1s1mjtN2A8CYROszHx9w1efC%2FqqQtJXvxBwJVoTOdaHSb1g4asBnRjt7O8aM4&amp;tag"><img
                                        class="product-image_image"
                                        src="https://ae01.alicdn.com/kf/H8ff92b119ae643ad913c193620e528ecx.jpg_220x220.jpg"></a>
                            </div>
                        </div>
                        <div class="product-content grid">
                            <div class="product-primary-details">
                                <h6 class="product-title grid line-limit"><a target="_blank"
                                        href="https://api.aliseeks.com/products/redirect?path=AfH6f72Kph5261XIds8Fk7DbtSClCi1P%2BY8Ufj1PO6wLXFGbLPSzH2qbCWk0LlOvyXKApMJ2jfMwVFbpMQCENZcIjY6Ie6QLHx6vBwsHPj6TNlkA76frxxIhtvqtFhU2xmJhf6gdYk0w8hesrtyRlXObhQ6zLpzd1Is1s1mjtN2A8CYROszHx9w1efC%2FqqQtJXvxBwJVoTOdaHSb1g4asBnRjt7O8aM4&amp;tag">
                                        Футболка хорошего качества femme, летняя брендовая мужская рубашка поло с
                                        коротким рукавом, Повседневная хлопковая Модная рубашка с отворото... </a></h6>
                            </div>
                            <div class="product-details grid">
                                <div class="product-price"><span class="product-price-price"> US $4.19 </span>
                                    <!---->
                                </div>
                                <!---->
                                <!---->
                                <div class="product-shipping ng-star-inserted">
                                    <!---->
                                    <!---->
                                    <!----> Отправка: US $10.53 </div>
                                <a-product-tags _nghost-vlh-c11="">
                                    <div _ngcontent-vlh-c11="" class="product-quality">
                                        <div _ngcontent-vlh-c11="" class="product-ratings-orders">
                                            <!---->
                                            <!---->
                                            <div _ngcontent-vlh-c11="" class="ng-star-inserted">
                                                <!----> 1 продано </div>
                                        </div>
                                        <div _ngcontent-vlh-c11="">
                                            <!---->
                                        </div>
                                    </div>
                                </a-product-tags>
                                <a-product-seller>
                                    <!---->
                                    <div class="product-seller ng-star-inserted"><span></span>
                                        <!---->
                                    </div>
                                </a-product-seller>
                                <a-product-actions>
                                    <div class="product-actions grid"><a class="button is-rounded tooltip"
                                            data-tooltip="Find similar products"
                                            href="search/image?imageurl=https%3A%2F%2Fae01.alicdn.com%2Fkf%2FH8ff92b119ae643ad913c193620e528ecx.jpg_220x220.jpg"><span
                                                class="icon is-small"><svg class="svg-inline--fa fa-search-plus fa-w-16"
                                                    aria-hidden="true" data-prefix="fa" data-icon="search-plus"
                                                    role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                                    data-fa-i2svg="">
                                                    <path fill="currentColor"
                                                        d="M304 192v32c0 6.6-5.4 12-12 12h-56v56c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-56h-56c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h56v-56c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v56h56c6.6 0 12 5.4 12 12zm201 284.7L476.7 505c-9.4 9.4-24.6 9.4-33.9 0L343 405.3c-4.5-4.5-7-10.6-7-17V372c-35.3 27.6-79.7 44-128 44C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208c0 48.3-16.4 92.7-44 128h16.3c6.4 0 12.5 2.5 17 7l99.7 99.7c9.3 9.4 9.3 24.6 0 34zM344 208c0-75.2-60.8-136-136-136S72 132.8 72 208s60.8 136 136 136 136-60.8 136-136z">
                                                    </path>
                                                </svg><!-- <i class="fa fa-search-plus"></i> --></span></a></div>
                                </a-product-actions>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="product-image"><a target="_blank"
                                href="https://api.aliseeks.com/products/redirect?path=MTIVJwgWpA7ehpAZnSf3e2i74rq58FKcxMesu6VWBsKqFDcQZIt3a%2BSrmfY2YbeSVEmCb5UFaFcjjqn1dhkTa6Wc2pfWJV3wh0AWxOP28tZMbdGjlvZFj4PUlWZsFITmO7%2FsC%2B8IjS9Glq%2BixIEtfI4MZFP4X7HuYTIYr240uqrgOtm7SyegXAXelIfmXf1jtD8p%2FvvnniOf60ByFLyhag4410JGMRLg&amp;tag"><img
                                    class="product-image_image"
                                    src="https://ae01.alicdn.com/kf/HTB1ssayL4TpK1RjSZR0q6zEwXXaW.jpg_220x220.jpg"></a>
                        </div>
                        <div class="product-content grid">
                            <div class="product-primary-details">
                                <h6 class="product-title grid line-limit"><a target="_blank"
                                        href="https://api.aliseeks.com/products/redirect?path=MTIVJwgWpA7ehpAZnSf3e2i74rq58FKcxMesu6VWBsKqFDcQZIt3a%2BSrmfY2YbeSVEmCb5UFaFcjjqn1dhkTa6Wc2pfWJV3wh0AWxOP28tZMbdGjlvZFj4PUlWZsFITmO7%2FsC%2B8IjS9Glq%2BixIEtfI4MZFP4X7HuYTIYr240uqrgOtm7SyegXAXelIfmXf1jtD8p%2FvvnniOf60ByFLyhag4410JGMRLg&amp;tag">
                                        Летняя спортивная футболка Мужская s обувь для бега Футболка мужская Спортивная
                                        тонкая спортивная одежда Спортивная Футболка Мужская хлоп... </a></h6>
                            </div>
                            <div class="product-details grid">
                                <div class="product-price"><span class="product-price-price"> US $6.31 </span>
                                    <!---->
                                </div>
                                <!---->
                                <!---->
                                <div class="product-shipping free-shipping ng-star-inserted">
                                    <!---->
                                    <!----> Бесплатная доставка
                                    <!---->
                                </div>
                                <a-product-tags _nghost-vlh-c11="">
                                    <div _ngcontent-vlh-c11="" class="product-quality">
                                        <div _ngcontent-vlh-c11="" class="product-ratings-orders">
                                            <!---->
                                            <!---->
                                            <div _ngcontent-vlh-c11="" class="ng-star-inserted">
                                                <!----> 18 продано </div>
                                        </div>
                                        <div _ngcontent-vlh-c11="">
                                            <!---->
                                        </div>
                                    </div>
                                </a-product-tags>
                                <a-product-seller>
                                    <!---->
                                    <div class="product-seller ng-star-inserted"><span></span>
                                        <!---->
                                    </div>
                                </a-product-seller>
                                <a-product-actions>
                                    <div class="product-actions grid"><a class="button is-rounded tooltip"
                                            data-tooltip="Find similar products"
                                            href="search/image?imageurl=https%3A%2F%2Fae01.alicdn.com%2Fkf%2FHTB1ssayL4TpK1RjSZR0q6zEwXXaW.jpg_220x220.jpg"><span
                                                class="icon is-small"><svg class="svg-inline--fa fa-search-plus fa-w-16"
                                                    aria-hidden="true" data-prefix="fa" data-icon="search-plus"
                                                    role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                                    data-fa-i2svg="">
                                                    <path fill="currentColor"
                                                        d="M304 192v32c0 6.6-5.4 12-12 12h-56v56c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-56h-56c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h56v-56c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v56h56c6.6 0 12 5.4 12 12zm201 284.7L476.7 505c-9.4 9.4-24.6 9.4-33.9 0L343 405.3c-4.5-4.5-7-10.6-7-17V372c-35.3 27.6-79.7 44-128 44C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208c0 48.3-16.4 92.7-44 128h16.3c6.4 0 12.5 2.5 17 7l99.7 99.7c9.3 9.4 9.3 24.6 0 34zM344 208c0-75.2-60.8-136-136-136S72 132.8 72 208s60.8 136 136 136 136-60.8 136-136z">
                                                    </path>
                                                </svg><!-- <i class="fa fa-search-plus"></i> --></span></a></div>
                                </a-product-actions>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="product-image"><a target="_blank"
                                href="https://api.aliseeks.com/products/redirect?path=4%2BMMSq8FrsAJbhMDUgYzKhqVd0nOS5alCNH5622%2Bn7TgsyBnkxBO5pj94RL7BJZ50c2%2Fi3I95pRyTMNVyk6tpz2INnlCW%2BIRe6wU4wQUKKEeBvfpvFwLejtKgckG5tatvvEr8OO65ydDzx%2BcAN%2BBYWcWcrpStlMehoLndWcPBNex%2BPRbe0jYdsfHSQyBZ1xR8nLwo%2BtUI%2Fa7DPd%2BnjtzBe%2FtPbWRY7q6&amp;tag"><img
                                    class="product-image_image"
                                    src="https://ae01.alicdn.com/kf/HTB1chelelCw3KVjSZFuq6AAOpXa4.jpg_220x220.jpg"></a>
                        </div>
                        <div class="product-content grid">
                            <div class="product-primary-details">
                                <h6 class="product-title grid line-limit"><a target="_blank"
                                        href="https://api.aliseeks.com/products/redirect?path=4%2BMMSq8FrsAJbhMDUgYzKhqVd0nOS5alCNH5622%2Bn7TgsyBnkxBO5pj94RL7BJZ50c2%2Fi3I95pRyTMNVyk6tpz2INnlCW%2BIRe6wU4wQUKKEeBvfpvFwLejtKgckG5tatvvEr8OO65ydDzx%2BcAN%2BBYWcWcrpStlMehoLndWcPBNex%2BPRbe0jYdsfHSQyBZ1xR8nLwo%2BtUI%2Fa7DPd%2BnjtzBe%2FtPbWRY7q6&amp;tag">
                                        Хлопковая мужская футболка с короткими рукавами с круглым вырезом, тонкая
                                        Однотонная футболка с короткими рукавами 2019 BRZK </a></h6>
                            </div>
                            <div class="product-details grid">
                                <div class="product-price"><span class="product-price-price"> US $3.54 </span>
                                    <!---->
                                </div>
                                <!---->
                                <!---->
                                <div class="product-shipping ng-star-inserted">
                                    <!---->
                                    <!---->
                                    <!----> Отправка: US $5.26 </div>
                                <a-product-tags _nghost-vlh-c11="">
                                    <div _ngcontent-vlh-c11="" class="product-quality">
                                        <div _ngcontent-vlh-c11="" class="product-ratings-orders">
                                            <!---->
                                            <!---->
                                        </div>
                                        <div _ngcontent-vlh-c11="">
                                            <!---->
                                        </div>
                                    </div>
                                </a-product-tags>
                                <a-product-seller>
                                    <!---->
                                    <div class="product-seller ng-star-inserted"><span></span>
                                        <!---->
                                    </div>
                                </a-product-seller>
                                <a-product-actions>
                                    <div class="product-actions grid"><a class="button is-rounded tooltip"
                                            data-tooltip="Find similar products"
                                            href="search/image?imageurl=https%3A%2F%2Fae01.alicdn.com%2Fkf%2FHTB1chelelCw3KVjSZFuq6AAOpXa4.jpg_220x220.jpg"><span
                                                class="icon is-small"><svg class="svg-inline--fa fa-search-plus fa-w-16"
                                                    aria-hidden="true" data-prefix="fa" data-icon="search-plus"
                                                    role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                                    data-fa-i2svg="">
                                                    <path fill="currentColor"
                                                        d="M304 192v32c0 6.6-5.4 12-12 12h-56v56c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-56h-56c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h56v-56c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v56h56c6.6 0 12 5.4 12 12zm201 284.7L476.7 505c-9.4 9.4-24.6 9.4-33.9 0L343 405.3c-4.5-4.5-7-10.6-7-17V372c-35.3 27.6-79.7 44-128 44C93.1 416 0 322.9 0 208S93.1 0 208 0s208 93.1 208 208c0 48.3-16.4 92.7-44 128h16.3c6.4 0 12.5 2.5 17 7l99.7 99.7c9.3 9.4 9.3 24.6 0 34zM344 208c0-75.2-60.8-136-136-136S72 132.8 72 208s60.8 136 136 136 136-60.8 136-136z">
                                                    </path>
                                                </svg><!-- <i class="fa fa-search-plus"></i> --></span></a></div>
                                </a-product-actions>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="row row-equal carousel-item m-t-0">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-img-top card-img-top-250">
                            <img class="img-fluid" src="clothes/ds/img/image4.jpg" alt="Carousel 1">
                        </div>
                        <div class="card-block p-t-2">
                            <div class="card-header">
                                <h3>flower1</h3>
                            </div>
                            <div class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Praesentium
                                animi molestias veritatis, pariatur dolorem error non reprehenderit vero, id. Incidunt
                                hic laudantium soluta recusandae, voluptas libero et! Ipsa, maiores, ratione.</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-img-top card-img-top-250">
                            <img class="img-fluid" src="clothes/ds/img/image5.jpg" alt="Carousel 1">
                        </div>
                        <div class="card-block p-t-2">
                            <div class="card-header">
                                <h3>flower1</h3>
                            </div>
                            <div class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Praesentium
                                animi molestias veritatis, pariatur dolorem error non reprehenderit vero, id. Incidunt
                                hic laudantium soluta recusandae, voluptas libero et! Ipsa, maiores, ratione.</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-img-top card-img-top-250">
                            <img class="img-fluid" src="clothes/ds/img/image6.jpg" alt="Carousel 1">
                        </div>
                        <div class="card-block p-t-2">
                            <div class="card-header">
                                <h3>flower1</h3>
                            </div>
                            <div class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Praesentium
                                animi molestias veritatis, pariatur dolorem error non reprehenderit vero, id. Incidunt
                                hic laudantium soluta recusandae, voluptas libero et! Ipsa, maiores, ratione.</div>
                        </div>
                    </div>
                </div>
            </div>
            <a class="carousel-control-prev" href="#productsCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#productsCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </section>





    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"
        integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
        integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>
    <script>
        var src = 'clothes/ds/img/1.jpg';
        var polygons = null;

        (function ($) {
            "use strict";
            $('.next').click(function () { $('.carousel').carousel('next'); return false; });
            $('.prev').click(function () { $('.carousel').carousel('prev'); return false; });
        })
            (jQuery);


        $('#photosCarousel').on('slide.bs.carousel', function () {
            setTimeout(function () {
                src = $('.active').find('img').attr('src');
            }, 300);
        });


        function clearBox(elementID) {
            document.getElementById(elementID).innerHTML = "";
        }


        $(document).ready(function () {
            $("#processButton").click(function () {
                var nm = src.split("/")
                httpGetAsync('http://169.60.115.34:5000/api/v1/scan?img=' + nm[nm.length - 1], callback);
            });
        });


        function httpGetAsync(theUrl, callback) {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                    callback(xmlHttp.responseText);
            }
            xmlHttp.open("GET", theUrl, true); // true for asynchronous 
            xmlHttp.send(null);
        }


        function callback(json_txt) {
            var json = JSON.parse(json_txt);
            var img = new Image();

            img.onload = function () {

                var max_height = document.getElementById('photosCarousel').offsetHeight;
                var max_width = document.getElementById('photosCarousel').offsetWidth;
                var scale_factor = max_height / img.height;


                img.width = img.width * scale_factor;
                img.height = img.height * scale_factor;

                // ctx.drawImage(img, 0, 0, img.width, img.height);

                var elem = document.getElementById('svg-overlay');
                var two = new Two({
                    width: max_width,
                    height: img.height,
                    fullscreen: false,
                    autostart: true
                }).appendTo(elem);


                for (var j = json.items.length - 1; j >= 0; j--) {
                    var vertices = [];
                    for (var i = json.items[j].points.length - 1; i >= 0; i--) {
                        vertices.push(new Two.Anchor(json.items[j].points[i][0] * scale_factor + (max_width / 4) + 15, json.items[j].points[i][1] * scale_factor))
                    }
                    var path = new Two.Path(vertices, true, false, false);
                    path.opacity = 0.3;

                    two.add(path);
                    two.update();
                    $(path._renderer.elem)
                        .css('cursor', 'pointer')
                        .click(function (e) {
                            path.fill = '#FF0000';
                            var x = document.getElementById("productsCarousel");
                            if (x.style.display === "none") {
                                x.style.display = "block";
                            } else {
                                x.style.display = "none";
                            }
                        });
                }



            };

            img.src = src
        }




    </script>
</body>

</html>